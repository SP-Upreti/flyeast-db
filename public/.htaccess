<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
# Enable CORS headers
<IfModule mod_headers.c>
  Header set Access-Control-Allow-Origin "*"
  Header set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, PATCH, OPTIONS"
  Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
</IfModule>

# Proxy API requests to the actual API server
# This prevents API calls from being served index.html
RewriteCond %{REQUEST_URI} ^/api/
RewriteRule ^api/(.*)$ https://flyeastapi.webxnepal.com/api/v1/$1 [P,L]

# If mod_proxy is not available (common on shared hosting), use redirect instead
# Uncomment the following two lines and comment out the [P,L] rule above:
# RewriteCond %{REQUEST_URI} ^/api/
# RewriteRule ^api/(.*)$ https://flyeastapi.webxnepal.com/api/v1/$1 [R=307,L]

# Handle index.html
  RewriteRule ^index\.html$ - [L]
# Serve existing files and directories as-is
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-l
# For all other requests (not API, not existing files), serve index.html for SPA routing
  RewriteRule . /index.html [L]
</IfModule>
